# Changelog

## 0.4.4 2025-02-22

- API呼び出し時の「予期しないエラー」への対処療法

## 0.4.3 2025-01-03

- タイムライン拡張ポップアップメニューの発動条件を選択可能にした
  - 今までは `ホイールクリック` または `Shift+Ctrl+右クリック` のどちらでも発動できましたが、今後はデフォルトで `Shift+Ctrl+右クリック` になり、設定から `ホイールクリック` または無効化できるようになります。

## 0.4.2 2024-02-28

- ビルド環境のメンテナンス
- 多重起動時のメッセージを改善

## 0.4.1 2023-11-25

- API でのカーソル移動後は遅延を入れて再描画するように改善

## 0.4.0 2023-11-24

- 依存ライブラリを更新
- ビルド環境のメンテナンス
- `GCMZDrops.isutf8()` を追加

## 0.4.0rc1 2023-04-22

- 処理モードが `自動` のときにシステムフォルダーが存在しなくても処理を続行できるようにした

## 0.4.0beta11 2023-04-15

- 中国語(簡体字)の翻訳を更新(#28)

## 0.4.0beta10 2023-04-15

- 多言語化向けの多数の変更
- 開発環境を MINGW32 から CLANG32 に切り替え

## 0.4.0beta9 2022-09-22

- 外部連携用 API からファイルをドロップしたときにカーソル位置が正しく移動されないことがある問題を修正

## 0.4.0beta8 2022-06-27

- 拡張編集 0.92 でのレイヤーの高さの取得方法を変更
- 拡張編集 0.92 でのカーソル位置の取得方法を変更

## 0.4.0beta7 2022-06-16

- exo 変換機能で必要になる対応表を exo ファイルから自動生成する仕組みを追加
  - 初期状態で存在するすべてのオブジェクトの自動変換に対応したはず

## 0.4.0beta6 2022-06-13

- 拡張編集 0.92 でのタイムライン拡大率取得方法を変更
- 本家版の拡張編集で作成した `*.exo` や `*.exa` を翻訳版で読み込めるようにする変換機能を追加（拡張編集 0.92のみ）
  - 翻訳版で作成したものを本家版で読み込むのも可能になりますが、大半のユーザーには必要なさそうなので現在は無効化済み
  - 対応表を作って地道に変換する仕組みであり、対応表がまだ未完成なので非対応オブジェクトでは上手くいきません

## 0.4.0beta5 2022-05-12

- エラーメッセージが空白になる問題を修正
- 中国語簡体字パッチが当たっている環境で起動できるように修正

## 0.4.0beta4 2022-04-12

- 実行環境検出が間違っていたのを修正

## 0.4.0beta3 2022-04-09

- ファイル作成時の属性が正しくなかったのを修正
- package.path / package.cpath の書き換え方法を変更
- 依存ライブラリの変更
- デフォルト値の保存方法を変更
- 開発環境の整備

## 0.4.0beta2 2021-12-10

- 設定のデフォルト値を変更できるようにした
- `GCMZDrops.findallfile()` の挙動を 0.3.x に近づけた

## 0.4.0beta1 2021-12-03

- Wine など一部の環境で期待通りに動かなかったのを修正
- その他多数の変更

## 0.3.25 2021-08-04

- 拡張編集のウィンドウを表示していない状態で外部連携用 API を呼び出すと上手く動かなかったのを修正
- 外部連携用 API の呼び出しでエラーダイアログを出し、閉じずに更に一度外部連携用 API を呼び出すとフリーズする問題を修正
- 外部連携用 API の呼び出しでエラーダイアログが出た場合、それを閉じるまで SendMessage から処理が戻らなかったのを改善
  - メッセージボックスを表示する前に処理は戻りますが、次の SendMessage はダイアログを閉じるまで待ち状態になります

## 0.3.24 2021-08-02

- 外部連携用 API の使用時にウィンドウが表示されているかチェックしないようにした
  - 0.3.10 以降は AviUtl を最小化した状態でも上手く動くはずなので開放しました
  - もし動かない環境がある場合は教えて下さい

## 0.3.23 2021-08-02

- GCMZDrops.englishpatched を追加
  - 拡張編集に英語化パッチが当たっている場合 true を返します
- 外部連携用 API に Flags フィールドを追加
  - 拡張編集に英語化パッチが当たっているかを取得可能です

## 0.3.22 2021-08-01

- 拡張編集のバージョンチェックの失敗時に理由を表示するようにした
- ロケールの設定によってバージョンチェックに失敗することがあったのを修正

## 0.3.21 2021-08-01

- 0.3.20 の間違いを修正

## 0.3.20 2021-08-01

- 英語化パッチを当てた拡張編集でも動くように修正

## 0.3.19 2021-07-17

- 外部連携用 API で frameAdvance 省略時の挙動が正しくなかったのを修正

## 0.3.18 2021-07-09

- 0.3.17 のイベントハンドルリークを修正

## 0.3.17 2021-07-09

- 外部連携用 API を連続で呼び出すと上手く動かないことがあったのを修正

## 0.3.16 2020-09-05

- 外部連携用 API が 16bit カラーモードで動かなかったのを修正

## 0.3.15 2020-08-21

- Lua 用のメモリアロケーターを変更

## 0.3.14 2020-08-17

- 保存先のデフォルト設定を `%PROJECTDIR%` に変更
  - プロジェクトファイル一式を丸ごと移動したときに、同じ場所にあるファイルなら上手く読み込んでくれる仕様を活用するため
- 共有メモリの更新時に `FlushViewOfFile` を呼ぶようにした

## 0.3.13 2020-06-25

- 0.3.12 未満のバージョンが動作中に 0.3.12 を多重起動すると深刻な問題が起こるバグを修正

## 0.3.12 2020-06-25

- 外部連携 API 周りを改修
  - 共有データへのアクセス前に Mutex で排他制御するようにした
  - API バージョンを取得できるようになった
  - 現在開いているプロジェクトのパスを取得できるようになった
  - ドロップ用データの送信に JSON を使えるようにした
  - 今までの API も廃止予定はありませんが `OpenMutex` が成功する場合は排他制御を推奨

## 0.3.11 2019-10-04

- AviUtl 1.10 でウィンドウレイアウトが崩れるのを修正
- 拡張編集 0.93rc1 に対応

## 0.3.10 2019-09-07

- 0.3.4 での対策を全ての環境に対して行うように変更
- レイヤーの高さやタイムライン表示倍率の検出に失敗した時はエラーで中断するように変更
- エラー通知の際に `gcmz-apierr-20191231-235959.bmp` のようなファイル名で検出失敗画像を保存するように変更

## 0.3.9 2019-03-26

- GCMZDrops.detectencoding で BOM を元に UTF-16 が検出できるように
- GCMZDrops.convertencoding で BOM を見つけた時は自動的に除去するように変更

## 0.3.8 2018-06-18

- LuaJIT への lua51.dll の差し替えを現時点では非サポートとして説明書に記載を追記

## 0.3.7 2018-05-22

- 特定の状況下で外部連携 API がプロジェクト情報を正しく取得できなかった問題を修正

## 0.3.6 2018-05-18

- ごちゃまぜドロップスの v0.1 系が共存している時はエラーを出すようにした

## 0.3.5 2018-04-18

- dropper スクリプト中に例外が発生するとフリーズしていたのを修正
- テキストファイルの自動エンコーディング変換の処理を改善
  - BOM 付き UTF-8 ファイルの時は BOM を除去
  - 後続の処理で利用できるように mediatype を付与

## 0.3.4 2018-04-16

- Vista/7 の Aero が無効の環境で外部連携用 API が動作しないことがあったのを修正

## 0.3.3 2018-04-11

- 外部連携 API の FrameAdv をスクリプトからコントロール可能できるよう改善

## 0.3.2 2018-04-11

- GCMZDrops.decodeexotextutf8 が上手く動かないことがあったのを修正

## 0.3.1 2018-04-10

- ファイル名に Shift_JIS にない文字が含まれている時はエラーメッセージを出しながら蹴るように変更
- GCMZDrops.decodeexotextutf8 を追加

## 0.3 2018-04-08

- レイヤーの高さを変更した直後は複数ファイルドロップが上手く動かなかったのを修正
- 実験的な外部連携用 API を追加

## 0.3rc3 2018-04-05

- *.wmv と *_mask.wmv があると自動的にマスクとして設定するスクリプトを追加

## 0.3rc2 2018-04-05

- ドロッパーのメニューが正しく追加できないことがあったのを修正
- GCMZDrops.getclipboard を追加
- ドロッパー用スクリプトを追加
- その他細かいバグ修正など

## 0.3rc 2018-03-14

- GCMZDrops.encodeexotextutf8 を追加

## 0.3beta3 2018-02-15

- README.txt を GCMZDrops.txt にリネーム
- ドロッパー用スクリプトに注意書きを追加
- 機能面に変更はありません

## 0.3beta2 2018-01-16

- ドロッパーシステム周辺の処理を改善
- GCMZDrops.doevents を追加

## 0.3beta 2018-01-12

- 動作環境チェックをより厳密に行うように改善
- スクリプトで制御可能なドロッパーシステムを追加

## 0.2.3 2017-11-29

- 動作モード「コピーを作成」が正しく動いていなかったのを修正
- avoiddup.lua が存在しない時の挙動を改善

## 0.2.2 2017-11-17

- 正式リリース

## 0.2.2rc2 2017-11-17

- 特殊フォルダーのパス取得時にエラーが発生しても無視するように変更

## 0.2.2rc 2017-11-17

- 初期化周りのコードを整理など

## 0.2.1 2017-11-03

- GCMZDrops.inistring を追加
- GCMZDrops.inifile を追加
- GCMZDrops.scriptdir を追加

## 0.2 2017-10-05

- 正式リリース

## 0.2rc4 2017-09-27

- モーダルダイアログが出ている時の挙動を改善

## 0.2rc3 2017-09-26

- エラーメッセージをわかりやすいものに改善

## 0.2rc2 2017-09-26

- Plugins ディレクトリに配置された時に動かなかったのを修正

## 0.2rc 2017-09-25

- すべての処理を刷新し、主要な処理を Lua 上で再実装
- 0.1 系を使用していたプロジェクトを 0.2 に移行すると重複ファイル抑制が正しく働かないことがあります

## 0.1.5 2016-03-16

- テキストドロップ時の文字コード変換処理を改善

## 0.1.4 2016-03-15

- [PSDTool](https://oov.github.io/psdtool/) でお気に入りプレビューモードからファイルをドロップした時はお気に入りの登録名をデフォルトファイル名として採用する

## 0.1.3 2016-02-18

- 初期化失敗時の挙動をよりフレンドリーな形に変更
- 配布アーカイブのドキュメントを README.md ファイルではなくリンクを含めるように変更

## 0.1.2 2016-02-17

- *.exo, *.exa のドロップが正しく処理されなかったバグを修正

## 0.1.1 2016-02-17

- 画像ファイルをひとつだけ投げた時に処理モードが正しく反映されなかったバグを修正

## 0.1 2016-02-16

- 初版
